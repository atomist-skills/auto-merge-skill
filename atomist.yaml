#
#  Copyright Â© 2020 Atomist, Inc.
#
#  Licensed under the Apache License, Version 2.0 (the "License");
#  you may not use this file except in compliance with the License.
#  You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
#  Unless required by applicable law or agreed to in writing, software
#  distributed under the License is distributed on an "AS IS" BASIS,
#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
#  See the License for the specific language governing permissions and
#  limitations under the License.
# 
    
skill:
  name: atomist/github-auto-merge-skill
  title: GitHub Auto-merge pull request
  version: 1.0.4
  author: Atomist
  description: |-
    Automatically merge pull requests that pass all checks required to merge
  documentation: |-
    Automatically merge pull requests on GitHub based on assigned labels. Required reviews
    and checks settings configured in the repository on GitHub are used as the rules for auto
    merging.

    This approach makes is easy for pull request authors, or anyone with permissions in the
    repository, to flag a pull request for auto-merge simply by adding a label. The merge
    option can also be set with a label on the pull request.
  category:
    - productivity
  license: Apache-2.0
  homepage: https://github.com/atomist-skills/auto-merge-skill
  repository: https://github.com/atomist-skills/auto-merge-skill.git
  icon: https://images.atomist.com/rug/pull-request.png

  package:
    - use: atomist/package-sdm-skill/package
      parameters:
        main: node_modules/@atomist/skill/lib/function.js
        dependencies: keep

  runtime:
    memory: 1024
    name: nodejs10
    entry_point: entryPoint

parameters:
  - repo_filter:
      name: repos
      display_name: Repositories
      description: Select for which repositories pull request auto-merging should be available
      required: false
  - single_choice:
      name: mergeOn
      display_name: Default Auto-merge Policy
      description: |-
        Policy to use when auto-merging pull requests
      options:
        - text: On successful reviews
          value: on-approve
        - text: On successful status checks
          value: on-checks
      default_value: on-approve
      required: false
  - single_choice:
      name: mergeMethod
      display_name: Default Auto-merge Method
      description: |-
        Merge method to use when auto-merging pull requests and no method has been set on pull requests
        explicity via a label
      options:
        - text: Merge Commit
          value: merge
        - text: Squash and Merge
          value: squash
        - text: Rebase and Merge
          value: rebase
      default_value: merge
      required: false
