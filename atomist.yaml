#
#  Copyright Â© 2020 Atomist, Inc.
#
#  Licensed under the Apache License, Version 2.0 (the "License");
#  you may not use this file except in compliance with the License.
#  You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
#  Unless required by applicable law or agreed to in writing, software
#  distributed under the License is distributed on an "AS IS" BASIS,
#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
#  See the License for the specific language governing permissions and
#  limitations under the License.
# 
    
skill:
  name: atomist/github-auto-merge-skill
  title: Auto-merge pull request
  version: 2.0.4
  author: Atomist
  description: |-
    Automatically merge pull requests that pass all checks required to merge
  documentation: |-
    Automatically merge pull requests on GitHub based on assigned labels. Required reviews
    and checks settings configured in the repository on GitHub are used as the rules for auto
    merging.
    
    This approach makes is easy for pull request authors or anyone with permissions in the
    repository to flag a pull request for auto-merge simply by adding a label. The merge
    option can also be set with a label on the pull request.
  category:
    - CODE_REVIEW
    - DEV_EX
  license: Apache-2.0
  homepage: https://github.com/atomist-skills/github-auto-merge-skill
  repository: https://github.com/atomist-skills/github-auto-merge-skill.git
  icon: file://docs/images/icon.svg
  video: https://images.atomist.com/skills/github-auto-merge.gif

  package:
    use: atomist/package-npm-skill
    parameters:
      bundle: true
      sourceMaps: true
      minify: true

  runtime:
    memory: 1024
    name: nodejs10
    entry_point: entryPoint

resource_providers:
  - name: github
    description: GitHub
    type_name: GitHubAppResourceProvider
    min_required: 1
    max_allowed: 1
  - name: slack
    description: Slack
    type_name: SlackResourceProvider
    min_required: 0
    max_allowed: 1

parameters:
  - single_choice:
      name: mergeOn
      display_name: Default auto-merge policy
      description: |-
        Select the default policy to use when auto-merging pull requests
      options:
        - text: On successful reviews and status checks
          value: on-approve
        - text: On successful status checks
          value: on-check-success
      required: false
  - single_choice:
      name: mergeMethod
      display_name: Default auto-merge method
      description: |-
        Select the default merge method to use when auto-merging pull requests
      options:
        - text: Merge commit
          value: merge
        - text: Squash and merge
          value: squash
        - text: Rebase and merge
          value: rebase
      required: false
  - repo_filter:
      name: repos
      display_name: Which repositories
      description: ''
      required: false

